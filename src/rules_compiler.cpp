//
// Created by TaxMachine on 2023-09-22.
//
#include "rules_compiler.hpp"

#include <iostream>
#include <filesystem>

std::vector<const char*> RULES() {
    std::vector<const char*> rules;

    for (const auto &rule : std::filesystem::directory_iterator(".\\rules")) {
        if (rule.is_directory()) continue;
        if (rule.path().extension() == ".yar") {
            std::string rule_path = rule.path().string();
            const char *c_rule_path = rule_path.c_str();
            rules.push_back(c_rule_path);
        }
    }

    return rules;
}